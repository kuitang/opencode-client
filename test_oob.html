<!DOCTYPE html>
<html>
<head>
    <title>SSE OOB Test</title>
    <script src="https://unpkg.com/htmx.org@2.0.3"></script>
    <script src="https://unpkg.com/htmx-ext-sse@2.2.2/sse.js"></script>
    <script>
        htmx.logAll();
    </script>
</head>
<body>
    <h1>SSE OOB Test</h1>
    
    <button onclick="testOOB()">Test OOB</button>
    
    <div id="messages">
        <!-- Messages will appear here -->
    </div>
    
    <script>
        function testOOB() {
            // First, add a message without OOB
            const initialHTML = '<div id="test-msg" class="message">Initial message...</div>';
            document.getElementById('messages').innerHTML += initialHTML;
            
            // Then simulate an OOB update
            setTimeout(() => {
                const oobHTML = '<div id="test-msg" class="message" hx-swap-oob="outerHTML">Updated via OOB!</div>';
                // Process with HTMX
                htmx.swap('#messages', oobHTML, {swapStyle: 'beforeend'});
            }, 2000);
        }
    </script>
</body>
</html>